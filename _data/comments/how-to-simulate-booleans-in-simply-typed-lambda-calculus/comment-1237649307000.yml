name: jeremy
date: '2009-03-21 16:28:27'
url: ''
message: "I don't know whether this is the solution you're after, but it seems to be possible to define cond_t inductively over types. The grammar of types is \n<blockquote><pre>t ::= O | t -&gt; t | t * t</pre></blockquote>\nNow we can define\n<blockquote><pre>   Boolean = Base -&gt; Base -&gt; Base\n   true  = \\(k1 :: Base) -&gt; \\(k2 :: Base) -&gt; k1\n   false = \\(k1 :: Base) -&gt; \\(k2 :: Base) -&gt; k2</pre></blockquote>\nand cond at type t by the function [[-]] where (using a Haskelly\nnotation)\n<blockquote><pre>   [[O]] = \\(c::Boolean) -&gt; c\n   [[t1 -&gt; t2]] = \\(c :: Boolean) -&gt; \\(k1 :: t1) -&gt; \\(k2 :: t2) -&gt; \n                  \\(x::t1) -&gt; [[t2]] c (k1 x) (k2 x)\n   [[t1 * t2]] = \\(c :: Boolean) -&gt; \\(k1 :: t1*t2) -&gt; \\(k2 :: t1*t2) -&gt;\n                  ([[t1]] c (fst k1) (fst k2), [[t2]] c (snd k1) (snd k2))</pre></blockquote>\nNow we have a single definition of Boolean and we can obtain cond_t\nfor any particular t. In fact, we can define cond in Haskell using GADTs:\n<blockquote><pre>{-# LANGUAGE EmptyDataDecls,PatternSignatures,GADTs,KindSignatures,ScopedTypeVariables #-}\n\ndata Base\n\ndata Type :: * -&gt; * where\n     Base  :: Type Base\n     (:-&gt;) :: Type a -&gt; Type b -&gt; Type (a -&gt; b)\n     (:*)  :: Type a -&gt; Type b -&gt; Type (a, b)\n\ntype Boolean = Base -&gt; Base -&gt; Base\n\ntrue :: Boolean\ntrue = \\(k1 :: Base) -&gt; \\(k2 :: Base) -&gt; k1\n\nfalse :: Boolean\nfalse = \\(k1 :: Base) -&gt; \\(k2 :: Base) -&gt; k2\n\ncond :: Type t -&gt; Boolean -&gt; t -&gt; t -&gt; t\ncond Base = \\(c::Boolean) -&gt; c\ncond ((t1 :: Type t1) :-&gt; (t2 :: Type t2)) =\n    \\(c::Boolean) -&gt; \n    \\(k1 :: t1 -&gt; t2) -&gt;\n    \\(k2 :: t1 -&gt; t2) -&gt; \n    \\(x :: t1) -&gt;\n        cond t2 c (k1 x) (k2 x) \ncond ((t1 :: Type t1) :* (t2 :: Type t2)) = \n    \\(c::Boolean) -&gt;\n    \\(k1 :: (t1, t2)) -&gt;\n    \\(k2 :: (t1, t2)) -&gt;\n        (cond t1 c (fst k1) (fst k2), \n         cond t2 c (snd k1) (snd k2))</pre></blockquote>\n"
email: 1a22832368217941397442baeaec3152
